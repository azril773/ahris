{% extends "hrd_app/master/base.html" %}

{% block breadcrumb %}

<!-- <div class="alert alert-warning alert-dismissible tx-info"><marquee class="py-0" direction="left" onmouseover="this.stop()" onmouseout="this.start()">
    Untuk saat ini proses absensi tidak dapat dilakukan, sampai informasi ini ditiadakan.  
</marquee></div> -->

<div class="br-pagebody">  

    <div class="br-section-wrapper">
        <!-- Pesan Error -->
        {% for message in messages %}
        <div class="container-fluid p-0">
            {% if 'safe' in message.tags %}
            <div class="alert alert-info alert-dismissible" role="alert" >
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
                </button>
                <span class="tx-16"></span>{{ message | safe }}</span>
            </div>
            {% elif message.tags == "error" %}
            <div class="alert alert-danger alert-dismissible" role="alert" >
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
                </button>
                <span class="tx-16"></span>{{ message | safe }}</span>
            </div>
            {% else %}
            <div class="alert alert-{{ message.tags }} alert-dismissible" role="alert" >
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
                </button>
                <span class="tx-16"></span>{{ message }}</span>
            </div>
            {% endif %}
        </div>
        {% endfor %}

        <!-- Absensi -->
        <h6 class="tx-gray-800 tx-uppercase tx-bold tx-14 mg-b-10">Edit Pegawai</h6>
    
        <!-- Info absensi -->        
        <div class="d-flex align-items-center justify-content-start">     
            <div class="mg-r-auto">   
                            
            <!-- Button Registrasi -->
            <button data-target="#pilih_tgl_proses" data-toggle="modal" class="btn btn-primary mg-b-6">Registrasi</button>            

            <!-- Button Perjanjian & Kontrak Kerja -->
            <button data-target="#pilih_tgl_proses" data-toggle="modal" class="btn btn-dark mg-b-6">Perjanjian & Kontrak Kerja</button>

            <!-- Button Pegawai Non Aktif -->
            <a href="{% url 'pegawai' sid %}"><button class="btn btn-success mg-b-6">Pegawai Aktif</button></a> 

            <!-- Button Pegawai Non Aktif -->
            <a href="{% url 'non_aktif' sid %}"><button class="btn btn-danger mg-b-6">Pegawai Non Aktif</button></a> 

            </div>          
        </div>

        <br>           
       
        <div class="row">
            <div class="col-lg-12">
                <div id="wizard1">
                    <h3>General Data</h3>
                    <section>
                        <div class="form-layout form-layout-1">
                            <div class="row mg-b-10">
                              <div class="col-lg-6">
                                <div class="form-group">
                                  <label class="form-control-label tx-inverse">Nama: <span class="tx-danger">*</span></label>
                                  <input class="form-control" type="text" name="nama" id="nama" required>
                                </div>
                              </div>

                              <div class="col-lg-3">
                                <div class="form-group">
                                  <label class="form-control-label tx-inverse">Gender: <span class="tx-danger">*</span></label>
                                    <select name="gender" id="gender" class="form-control select2-show-search" required=required>
                                        <option value="Perempuan">Perempuan</option>
                                        <option value="Laki-Laki">Laki-Laki</option>
                                    </select>
                                </div>
                              </div>

                              <div class="col-lg-3">
                                <div class="form-group">
                                  <label class="form-control-label tx-inverse">Tgl Masuk: <span class="tx-danger">*</span></label>
                                  <input type="text" name="tgl_masuk" id="tgl_masuk" class="form-control tgl1" placeholder="tgl-bln-tahun" required>
                                </div>
                              </div> 
                              
                              <div class="col-lg-3">
                                <div class="form-group">
                                  <label class="form-control-label tx-inverse">NIK: <span class="tx-danger">*</span></label>
                                  <input class="form-control" type="text" name="nik" id="nik" required>
                                </div>
                              </div> 
                              
                              <div class="col-lg-3">
                                <div class="form-group">
                                  <label class="form-control-label tx-inverse">Userid: <span class="tx-danger">*</span></label>
                                  <input class="form-control" type="text" name="userid" id="userid" required>
                                </div>
                              </div> 

                              <div class="col-lg-3">
                                <div class="form-group">
                                  <label class="form-control-label tx-inverse">Divisi: <span class="tx-danger">*</span></label>
                                  <select name="div" id="div" class="form-control select2-show-search" data-placeholder="" required>
                                    <option label=""></option>
                                    {% for d in divisi %}
                                    <option value={{d.id}}>{{d.divisi}}</option>
                                    {% endfor %}
                                </select>
                                </div>
                              </div> 

                              <div class="col-lg-3">
                                <div class="form-group">
                                  <label class="form-control-label tx-inverse">Counter:</label>
                                  <select name="counter" id="counter" class="form-control select2-show-search" data-placeholder="" required>
                                    <option label=""></option>
                                    {% for c in counter %}
                                    <option value={{c.id}}>{{c.counter}}</option>
                                    {% endfor %}
                                </select>
                                </div>
                              </div> 

                              <div class="col-lg-3">
                                <div class="form-group">
                                  <label class="form-control-label tx-inverse">Jabatan:</label>
                                  <select name="jabatan" id="jabatan" class="form-control select2-show-search" data-placeholder="" required>
                                    <option label=""></option>
                                    {% for j in jabatan %}
                                    <option value={{j.id}}>{{j.jabatan}}</option>
                                    {% endfor %}
                                </select>
                                </div>
                              </div> 

                              <div class="col-lg-3">
                                <div class="form-group">
                                  <label class="form-control-label tx-inverse">Kelompok Kerja: <span class="tx-danger">*</span></label>
                                  <select name="kk" id="kk" class="form-control select2-show-search" data-placeholder="" required>
                                    <option label=""></option>
                                    {% for k in kk %}
                                    <option value={{k.id}}>{{k.kelompok}}</option>
                                    {% endfor %}
                                </select>
                                </div>
                              </div> 

                              <div class="col-lg-3">
                                <div class="form-group">
                                  <label class="form-control-label tx-inverse">Hari OFF: <span class="tx-danger">*</span></label>
                                  <select name="hr" id="hr" class="form-control select2-show-search" data-placeholder="" required>
                                    <option label=""></option>
                                    {% for h in hr %}
                                    <option value={{h.id}}>{{h.hari}}</option>
                                    {% endfor %}
                                </select>
                                </div>
                              </div> 

                              <div class="col-lg-3">
                                <div class="form-group">
                                  <label class="form-control-label tx-inverse">Cuti Awal: <span class="tx-danger">*</span></label>
                                  <input class="form-control" type="text" name="ca" id="ca">
                                </div>
                              </div> 

                              <div class="col-lg-3">
                                <div class="form-group">
                                  <label class="form-control-label tx-inverse">Rekening:</label>
                                  <input class="form-control" type="text" name="rek" id="rek">
                                </div>
                              </div> 

                              <div class="col-lg-3">
                                <div class="form-group">
                                  <label class="form-control-label tx-inverse">Payroll By: <span class="tx-danger">*</span></label>
                                  <select name="payroll" id="payroll" class="form-control select2-show-search" required>
                                    <option value="Lainnya">Lainnya</option>
                                    <option value="HRD">HRD</option>
                                    <option value="Owner">Owner</option>
                                </select>
                                </div>
                              </div> 

                              <div class="col-lg-3">
                                <div class="form-group">
                                  <label class="form-control-label tx-inverse">No. BPJS KS:</label>
                                  <input class="form-control" type="text" name="nks" id="nks">
                                </div>
                              </div> 

                              <div class="col-lg-3">
                                <div class="form-group">
                                  <label class="form-control-label tx-inverse">No. BPJS TK:</label>
                                  <input class="form-control" type="text" name="ntk" id="ntk">
                                </div>
                              </div> 

                              <div class="col-lg-3">
                                <div class="form-group">
                                  <label class="form-control-label tx-inverse">Premi KS:</label>
                                  <input class="form-control" type="text" name="pks" id="pks">
                                </div>
                              </div>
                              
                              <div class="col-lg-3">
                                <div class="form-group">
                                  <label class="form-control-label tx-inverse">Premi TK:</label>
                                  <input class="form-control" type="text" name="ptk" id="ptk">
                                </div>
                              </div> 
                              
                            </div>
                        </div>
                    </section>

                    <h3>Data Pribadi</h3>
                    <section>
                        <div class="form-layout form-layout-1">
                            <div class="row mg-b-10">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                    <label class="form-control-label tx-inverse">Alamat:</label>
                                    <input class="form-control" type="text" name="alamat" id="alamat" required>
                                    </div>
                                </div> 
                              
                                <div class="col-lg-3">
                                    <div class="form-group">
                                    <label class="form-control-label tx-inverse">HP / Telp.: <span class="tx-danger">*</span></label>
                                    <input class="form-control" type="text" name="phone" id="phone" required>
                                    </div>
                                </div>
                              
                                <div class="col-lg-3">
                                    <div class="form-group">
                                    <label class="form-control-label tx-inverse">Email:</label>
                                    <input class="form-control" type="email" name="email" id="email">
                                    </div>
                                </div>

                                <div class="col-lg-3">
                                    <div class="form-group">
                                    <label class="form-control-label tx-inverse">Kota Kelahiran: <span class="tx-danger">*</span></label>
                                    <input class="form-control" type="text" name="kota_lahir" id="kota_lahir" required>
                                    </div>
                                </div>

                                <div class="col-lg-3">
                                    <div class="form-group">
                                    <label class="form-control-label tx-inverse">Tgl Lahir: <span class="tx-danger">*</span></label>
                                    <input type="text" name="tgl_lahir" id="tgl_lahir" class="form-control tgl2" placeholder="tgl-bln-tahun" required>
                                    </div>
                                </div> 

                                <div class="col-lg-3">
                                    <div class="form-group">
                                    <label class="form-control-label tx-inverse">Tinggi Badan:</label>
                                    <input class="form-control" type="number" name="tinggi" id="tinggi">
                                    </div>
                                </div>

                                <div class="col-lg-3">
                                    <div class="form-group">
                                    <label class="form-control-label tx-inverse">Berat Badan:</label>
                                    <input class="form-control" type="text" name="berat" id="berat">
                                    </div>
                                </div>

                                <div class="col-lg-3">
                                    <div class="form-group">
                                    <label class="form-control-label tx-inverse">Gol Darah:</label>
                                    <select name="goldarah" id="goldarah" class="form-control select2-show-search" data-placeholder="">
                                        <option label=""></option>
                                        <option value="O">O</option>
                                        <option value="A">A</option>
                                        <option value="B">B</option>
                                        <option value="AB">AB</option>
                                    </select>
                                    </div>
                                </div> 

                                <div class="col-lg-3">
                                    <div class="form-group">
                                    <label class="form-control-label tx-inverse">Agama: <span class="tx-danger">*</span></label>
                                        <select name="agama" id="agama" class="form-control select2-show-search" required
                                    >
                                            <option value="Islam">Islam</option>
                                            <option value="Katholik">Katholik</option>
                                            <option value="Kristen">Kristen</option>
                                            <option value="Hindu">Hindu</option>
                                            <option value="Budha">Budha</option>
                                            <option value="Konghucu">Konghucu</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="col-lg-3">
                                    <div class="form-group">
                                    &nbsp;
                                    </div>
                                </div>
                                
                                <div class="col-lg-3">
                                    <div class="form-group">
                                    &nbsp;
                                    </div>
                                </div>
                              
                            </div>
                        </div>
                        
                        <p>&nbsp;</p>

                        <div class="form-layout form-layout-1">
                          <span class="tx-inverse">DATA KELUARGA</span> <br><br>

                          <div id="data_keluarga" class="row mg-b-10">       
                            
                              <div class="col-lg-12">
                                <form id="tambah_keluargaForm">
                                  {% csrf_token %}
                                  <div class="row mg-b-1">
                                    <div class="col-lg-3">
                                        <div class="form-group">
                                            <select name="thubungan_keluarga" id="thubungan_keluarga" class="form-control select2-show-search" data-placeholder="Pilih Hubungan">
                                                <option label="Pilih Hubungan"></option>            
                                                <option value="Ayah">Ayah</option>                                                
                                                <option value="Ibu">Ibu</option>
                                                <option value="Kakak">Kakak</option>
                                                <option value="Adik">Adik</option>
                                                <option value="Istri">Istri</option>
                                                <option value="Anak">Anak</option>
                                                <option value="Sepupu">Sepupu</option>
                                                <option value="Ipar">Ipar</option>
                                                <option value="Mertua">Mertua</option>
                                                <option value="Lainnya">Lainnya</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="col-lg-3">
                                        <div class="form-group">
                                        <input class="form-control" type="text" name="tnama_keluarga" id="tnama_keluarga" placeholder="Nama">    
                                        </div>
                                    </div>

                                    <div class="col-lg-2">
                                        <div class="form-group">
                                        <input type="text" name="ttgl_lahir_keluarga" id="ttgl_lahir_keluarga" class="form-control tgl3" placeholder="Tgl Lahir">
                                        </div>
                                    </div>

                                    <div class="col-lg-2">
                                        <div class="form-group">
                                            <select name="tgender_keluarga" id="tgender_keluarga" class="form-control select2-show-search" data-placeholder="Gender">
                                                <option label="Gender"></option>
                                                <option value="Perempuan">Perempuan</option>
                                                <option value="Laki-Laki">Laki-Laki</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="col-lg-2">
                                        <div class="form-group">
                                            <select name="tgoldarah_keluarga" id="tgoldarah_keluarga" class="form-control select2-show-search" data-placeholder="Gol Darah">
                                                <option label="Gol Darah"></option>
                                                <option value="O">O</option>
                                                <option value="A">A</option>
                                                <option value="B">B</option>
                                                <option value="AB">AB</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="col-lg-3">
                                      <div class="form-group">
                                          <button type="submit" class="btn btn-primary">Tambahkan</button>
                                      </div>
                                  </div>

                                  </div>
                                </form>
                              </div>
                              
                              {% for k in keluarga %}                              
                              <div class="col-lg-3">
                                  <div class="form-group">
                                      <select name="hubungan_keluarga" id="hubungan_keluarga-{{k.id}}" class="form-control select2-show-search">            
                                          <option value="Ayah">Ayah</option>                                                
                                          <option value="Ibu">Ibu</option>
                                          <option value="Kakak">Kakak</option>
                                          <option value="Adik">Adik</option>
                                          <option value="Istri">Istri</option>
                                          <option value="Anak">Anak</option>
                                          <option value="Sepupu">Sepupu</option>
                                          <option value="Ipar">Ipar</option>
                                          <option value="Mertua">Mertua</option>
                                          <option value="Lainnya">Lainnya</option>
                                      </select>
                                  </div>
                              </div>

                              <div class="col-lg-3">
                                  <div class="form-group">
                                  <input class="form-control" type="text" name="nama_keluarga" id="nama_keluarga-{{k.id}}" placeholder="Nama">    
                                  </div>
                              </div>

                              <div class="col-lg-2">
                                  <div class="form-group">
                                  <input type="text" name="tgl_lahir_keluarga" id="tgl_lahir_keluarga-{{k.id}}" class="form-control tgl4" placeholder="Tgl Lahir">
                                  </div>
                              </div> 

                              <div class="col-lg-2">
                                  <div class="form-group">
                                      <select name="gender_keluarga" id="gender_keluarga-{{k.id}}" class="form-control select2-show-search" data-placeholder="Gender">
                                          <option label="Gender"></option>
                                          <option value="Perempuan">Perempuan</option>
                                          <option value="Laki-Laki">Laki-Laki</option>
                                      </select>
                                  </div>
                              </div>

                              <div class="col-lg-2">
                                  <div class="form-group">
                                      <select name="goldarah_keluarga" id="goldarah_keluarga-{{k.id}}" class="form-control select2-show-search" data-placeholder="Gol Darah">
                                          <option label="Gol Darah"></option>
                                          <option value="O">O</option>
                                          <option value="A">A</option>
                                          <option value="B">B</option>
                                          <option value="AB">AB</option>
                                      </select>
                                  </div>
                              </div>
                              {% endfor %}
                            
                          </div>
                          
                        </div>

                        <p>&nbsp;</p>

                        <div class="form-layout form-layout-1">
                          <span class="tx-inverse">PIHAK YANG DAPAT DIHUBUNGI</span> <br><br>

                            <div id="data_kl" class="row mg-b-10">

                              <div class="col-lg-12">
                                <form id="tambah_klForm">
                                  {% csrf_token %}
                                  <div class="row mg-b-1">
                                    <div class="col-lg-3">
                                        <div class="form-group">
                                            <select name="thubungan_kl" id="thubungan_kl" class="form-control select2-show-search" data-placeholder="Pilih Hubungan">
                                                <option label="Pilih Hubungan"></option>            
                                                <option value="Ayah">Ayah</option>                                                
                                                <option value="Ibu">Ibu</option>
                                                <option value="Kakak">Kakak</option>
                                                <option value="Adik">Adik</option>
                                                <option value="Istri">Istri</option>
                                                <option value="Anak">Anak</option>
                                                <option value="Sepupu">Sepupu</option>
                                                <option value="Ipar">Ipar</option>
                                                <option value="Mertua">Mertua</option>
                                                <option value="Lainnya">Lainnya</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="col-lg-3">
                                        <div class="form-group">
                                        <input class="form-control" type="text" name="tnama_kl" id="tnama_kl" placeholder="Nama">    
                                        </div>
                                    </div>

                                    <div class="col-lg-3">
                                        <div class="form-group">
                                            <select name="tgender_kl" id="tgender_kl" class="form-control select2-show-search" data-placeholder="Gender">
                                                <option label="Gender"></option>
                                                <option value="Perempuan">Perempuan</option>
                                                <option value="Laki-Laki">Laki-Laki</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="col-lg-3">
                                        <div class="form-group">
                                          <input class="form-control" type="text" name="tphone" id="tphone" placeholder="HP / Telp.">   
                                        </div>
                                    </div>

                                    <div class="col-lg-3">
                                      <div class="form-group">
                                          <button type="submit" class="btn btn-primary">Tambahkan</button>
                                      </div>
                                  </div>

                                  </div>
                                </form>
                              </div>
                              
                              {% for l in kontak_lain %}
                              <!-- kontak lain -->
                              <div class="col-lg-3">
                                  <div class="form-group">
                                      <select name="hubungan_kl" id="hubungan_kl-{{l.id}}" class="form-control select2-show-search">            
                                          <option value="Ayah">Ayah</option>                                                
                                          <option value="Ibu">Ibu</option>
                                          <option value="Kakak">Kakak</option>
                                          <option value="Adik">Adik</option>
                                          <option value="Istri">Istri</option>
                                          <option value="Anak">Anak</option>
                                          <option value="Sepupu">Sepupu</option>
                                          <option value="Ipar">Ipar</option>
                                          <option value="Mertua">Mertua</option>
                                          <option value="Lainnya">Lainnya</option>
                                      </select>
                                  </div>
                              </div>

                              <div class="col-lg-3">
                                  <div class="form-group">
                                  <input class="form-control" type="text" name="nama_kl" id="nama_kl-{{l.id}}" placeholder="Nama">    
                                  </div>
                              </div>

                              <div class="col-lg-3">
                                  <div class="form-group">
                                      <select name="gender_kl" id="gender_kl-{{l.id}}" class="form-control select2-show-search" data-placeholder="Gender">
                                          <option label="Gender"></option>
                                          <option value="Perempuan">Perempuan</option>
                                          <option value="Laki-Laki">Laki-Laki</option>
                                      </select>
                                  </div>
                              </div>

                              <div class="col-lg-3">
                                  <div class="form-group">
                                    <input class="form-control" type="text" name="phone" id="phone-{{l.id}}" required>
                                  </div>
                              </div>
                              {% endfor %}
                            
                            </div>

                        </div>
                    </section>

                    <h3>Pengalaman Kerja & Pendidikan</h3>
                    <section>
                      <div class="form-layout form-layout-1">
                        <span class="tx-inverse">PENGALAMAN KERJA</span> <br><br>
                        <div class="row mg-b-10">
                            
                            {% for p in pengalaman %}
                            
                            <div class="col-lg-3">
                                <div class="form-group">
                                  <input type="text" name="perusahaan" id="perusahaan-{{p.id}}" class="form-control" placeholder="Nama Perusahaan">
                                </div>
                            </div>

                            <div class="col-lg-3">
                                <div class="form-group">
                                  <input type="text" name="kota" id="kota-{{p.id}}" class="form-control" placeholder="Kota">   
                                </div>
                            </div>

                            <div class="col-lg-2">
                                <div class="form-group">
                                  <input type="text" name="dtahun" id="dtahun-{{p.id}}" class="form-control" placeholder="Dari Tahun">
                                </div>
                            </div> 

                            <div class="col-lg-2">
                              <div class="form-group">
                                <input type="text" name="stahun" id="stahun-{{p.id}}" class="form-control" placeholder="Sampai Tahun">
                              </div>
                          </div> 

                            <div class="col-lg-2">
                                <div class="form-group">
                                  <input type="text" name="jabatan" id="jabatan-{{p.id}}" class="form-control" placeholder="Jabatan">
                                </div>
                            </div>
                            {% endfor %}
                          
                        </div>
                      </div>

                      <p>&nbsp;</p>

                      <div class="form-layout form-layout-1">
                        <span class="tx-inverse">PENDIDIKAN</span> <br><br>
                        <div class="row mg-b-10">
                            
                            {% for d in pendidikan %}
                            
                            <div class="col-lg-3">
                                <div class="form-group">
                                  <input type="text" name="lembaga" id="lembaga-{{d.id}}" class="form-control" placeholder="Nama Lembaga Pendidikan">
                                </div>
                            </div>

                            <div class="col-lg-2">
                                <div class="form-group">
                                  <input type="text" name="kota" id="kota_lembaga-{{d.id}}" class="form-control" placeholder="Kota">   
                                </div>
                            </div>

                            <div class="col-lg-2">
                                <div class="form-group">
                                  <input type="text" name="dtahun" id="dtahun_lembaga-{{d.id}}" class="form-control" placeholder="Dari Tahun">
                                </div>
                            </div> 

                            <div class="col-lg-2">
                              <div class="form-group">
                                <input type="text" name="stahun" id="stahun_lembaga-{{d.id}}" class="form-control" placeholder="Sampai Tahun">
                              </div>
                            </div> 

                            <div class="col-lg-3">
                                <div class="form-group">
                                  <input type="text" name="jurusan" id="jurusan-{{d.id}}" class="form-control" placeholder="Jurusan">
                                </div>
                            </div>

                            <div class="col-lg-3">
                              <div class="form-group">
                                <input type="text" name="gelar" id="gelar-{{d.id}}" class="form-control" placeholder="Gelar">
                              </div>
                            </div>
                            {% endfor %}
                          
                        </div>
                      </div>
                    </section>
                    
                </div>
            </div>
        </div>

        <!-- Modal -->

    </div>

</div><!-- br-pagebody -->

{% endblock breadcrumb %}

{% block hrd_ajax %}


<script>
    $('#wizard1').steps({
        headerTag: 'h3',
        bodyTag: 'section',
        autoFocus: true,
        titleTemplate: '<span class="number">#index#</span> <span class="title">#title#</span>'
    });

    document.getElementById("nama").defaultValue = "{{pg.nama}}";
    $('#gender').val('{{pg.gender}}').trigger("change");
    document.getElementById("tgl_masuk").defaultValue = "{{pg.tgl_masuk}}";
    
    document.getElementById("nik").defaultValue = "{{pg.nik}}";
    document.getElementById("userid").defaultValue = "{{pg.userid}}";
    $('#div').val('{{pg.divisi_id}}').trigger("change");
    $('#counter').val('{{pg.counter_id}}').trigger("change");

    $('#jabatan').val('{{pg.jabatan_id}}').trigger("change");
    $('#kk').val('{{pg.kelompok_kerja_id}}').trigger("change");
    $('#hr').val('{{pg.hari_off_id}}').trigger("change");
    document.getElementById("ca").defaultValue = "{{pg.sisa_cuti}}";

    document.getElementById("rek").defaultValue = "{{pg.rekening}}";
    $('#payroll').val('{{pg.payroll_by}}').trigger("change");
    document.getElementById("ntk").defaultValue = "{{pg.no_bpjs_tk}}";
    document.getElementById("nks").defaultValue = "{{pg.no_bpjs_ks}}";

    document.getElementById("pks").defaultValue = "{{pg.ks_premi}}";
    document.getElementById("ptk").defaultValue = "{{pg.tk_premi}}";
    

</script>

{% for k in keluarga%}
<script>
    $('#hubungan_keluarga-{{k.id}}').val('{{k.hubungan}}').trigger("change");
    document.getElementById("nama_keluarga-{{k.id}}").defaultValue = "{{k.nama}}";
    document.getElementById("tgl_lahir_keluarga-{{k.id}}").defaultValue = "{{k.tgl_lahir|date:'d-m-Y'}}";
    $('#gender_keluarga-{{k.id}}').val('{{k.gender}}').trigger("change");
    $('#goldarah_keluarga-{{k.id}}').val('{{k.gol_darah}}').trigger("change");

    $(document).on('click change', '#hubungan_keluarga-{{k.id}}', function() {
        if ($('#hubungan_keluarga-{{k.id}} :selected').text() == "Ayah") {
            $('#gender_keluarga-{{k.id}}').val('Laki-Laki').trigger("change");
        } else if ($('#hubungan_keluarga-{{k.id}} :selected').text() == "Ibu" || $('#hubungan_keluarga-{{k.id}} :selected').text() == "Istri"){
          $('#gender_keluarga-{{k.id}}').val('Perempuan').trigger("change");
        } else if ($('#hubungan_keluarga-{{k.id}} :selected').text() == "{{k.hubungan}}"){
          $('#gender_keluarga-{{k.id}}').val('{{k.gender}}').trigger("change");
        } else {
          $('#gender_keluarga-{{k.id}}').val('').trigger("change");
        }
    });
</script>
{% endfor %}

{% for l in kontak_lain%}
<script>
    $('#hubungan_kl-{{l.id}}').val('{{l.hubungan}}').trigger("change");
    document.getElementById("nama_kl-{{l.id}}").defaultValue = "{{l.nama}}";
    $('#gender_kl-{{l.id}}').val('{{l.gender}}').trigger("change");
    document.getElementById("phone-{{l.id}}").defaultValue = "{{l.phone}}";
</script>
{% endfor %}

{% for p in pengalaman%}
<script>
    document.getElementById("perusahaan-{{p.id}}").defaultValue = "{{p.perusahaan}}";
    document.getElementById("kota-{{p.id}}").defaultValue = "{{p.kota}}";
    document.getElementById("dtahun-{{p.id}}").defaultValue = "{{p.dari_tahun}}";
    document.getElementById("stahun-{{p.id}}").defaultValue = "{{p.sampai_tahun}}";
    document.getElementById("jabatan-{{p.id}}").defaultValue = "{{p.jabatan}}";
</script>
{% endfor %}

{% for d in pendidikan%}
<script>
    document.getElementById("lembaga-{{d.id}}").defaultValue = "{{d.nama}}";
    document.getElementById("kota_lembaga-{{d.id}}").defaultValue = "{{d.kota}}";
    document.getElementById("dtahun_lembaga-{{d.id}}").defaultValue = "{{d.dari_tahun}}";
    document.getElementById("stahun_lembaga-{{d.id}}").defaultValue = "{{d.sampai_tahun}}";
    document.getElementById("jurusan-{{d.id}}").defaultValue = "{{d.jurusan}}";
    document.getElementById("gelar-{{d.id}}").defaultValue = "{{d.gelar}}";
</script>
{% endfor %}

<!-- Tambah Record -->
<script>
  
  /* Tambah Keluarga */
  tambah_keluargaForm.addEventListener('submit', e => {
        e.preventDefault()

        const dhubungan_keluarga = document.getElementById('thubungan_keluarga')
        const dnama_keluarga = document.getElementById('tnama_keluarga')
        const dtgl_lahir_keluarga = document.getElementById('ttgl_lahir_keluarga')
        const dgender_keluarga = document.getElementById('tgender_keluarga')
        const dgol_darah = document.getElementById('tgoldarah_keluarga')
        const csrf = document.getElementsByName('csrfmiddlewaretoken')       

        $.ajax({
            type: 'POST',
            url: "{% url 'tkeluarga' idp %}",
            data: {
                'csrfmiddlewaretoken': csrf[0].value,
                'dhubungan_keluarga':dhubungan_keluarga.value,
                'dnama_keluarga': dnama_keluarga.value,
                'dtgl_lahir_keluarga':dtgl_lahir_keluarga.value,
                'dgender_keluarga':dgender_keluarga.value,
                'dgol_darah':dgol_darah.value
                
            },
            success: function (response) {
                                
                if (response.status == 'ok') { 
                    console.log(response.dnama)       
                } 
                
                $("#tambah_keluargaForm")[0].reset();
                $('#thubungan_keluarga').val('').trigger("change");
                $('#tgender_keluarga').val('').trigger("change");
                $('#tgoldarah_keluarga').val('').trigger("change");

                $('#data_keluarga').append('<div class="col-lg-3"><div class="form-group"><select id="hubungan_keluarga-'+response.idl+'" class="form-control select2-show-search"><option value="Ayah">Ayah</option><option value="Ibu">Ibu</option><option value="Kakak">Kakak</option><option value="Adik">Adik</option><option value="Istri">Istri</option><option value="Anak">Anak</option><option value="Sepupu">Sepupu</option><option value="Ipar">Ipar</option><option value="Mertua">Mertua</option><option value="Lainnya">Lainnya</option></select></div></div');
                
                $('#data_keluarga').append('<div class="col-lg-3"><div class="form-group"><input type="text" class="form-control" value="'+response.dnama+'""></div></div');

                $('#data_keluarga').append('<div class="col-lg-2"><div class="form-group"><input type="text" class="form-control tgl5" value="'+response.tlahir+'"></div></div');

                $('#data_keluarga').append('<div class="col-lg-2"><div class="form-group"><select id="gender_keluarga-'+response.idl+'" class="form-control select2-show-search"><option value="Perempuan">Perempuan</option><option value="Laki-Laki">Laki-Laki</option></select></div></div');

                $('#data_keluarga').append('<div class="col-lg-2"><div class="form-group"><select id="goldarah_keluarga-'+response.idl+'" class="form-control select2-show-search"><option value="O">O</option><option value="A">A</option><option value="B">B</option><option value="AB">AB</option></select></div></div');

                $("#hubungan_keluarga-"+response.idl).val(response.hub).trigger("change");
                $("#gender_keluarga-"+response.idl).val(response.gender).trigger("change");
                $("#goldarah_keluarga-"+response.idl).val(response.goldarah).trigger("change");
                      
            },
            error: function (error) {
                alert('Terjadi kesalahan sistem, hubungi IT.')
            }
        });

    });
  
  
  /* Tambah Pihak Lain */
  tambah_klForm.addEventListener('submit', e => {
          e.preventDefault()

          const dhubungan_kl = document.getElementById('thubungan_kl')
          const dnama_kl = document.getElementById('tnama_kl')
          const dgender_kl = document.getElementById('tgender_kl')
          const dphone = document.getElementById('tphone')
          const csrf = document.getElementsByName('csrfmiddlewaretoken')       

          $.ajax({
              type: 'POST',
              url: "{% url 'tkl' idp %}",
              data: {
                  'csrfmiddlewaretoken': csrf[0].value,
                  'dhubungan_kl':dhubungan_kl.value,
                  'dnama_kl': dnama_kl.value,
                  'dgender_kl':dgender_kl.value,
                  'dphone':dphone.value
                  
              },
              success: function (response) {
                                  
                  if (response.status == 'ok') { 
                      console.log(response.dnama)       
                  } 
                  
                  $("#tambah_klForm")[0].reset();
                  $('#thubungan_kl').val('').trigger("change");
                  $('#tgender_kl').val('').trigger("change");

                  $('#data_kl').append('<div class="col-lg-3"><div class="form-group"><select id="hubungan_kl-'+response.idl_kl+'" class="form-control select2-show-search"><option value="Ayah">Ayah</option><option value="Ibu">Ibu</option><option value="Kakak">Kakak</option><option value="Adik">Adik</option><option value="Istri">Istri</option><option value="Anak">Anak</option><option value="Sepupu">Sepupu</option><option value="Ipar">Ipar</option><option value="Mertua">Mertua</option><option value="Lainnya">Lainnya</option></select></div></div');
                  
                  $('#data_kl').append('<div class="col-lg-3"><div class="form-group"><input type="text" class="form-control" value="'+response.dnama_kl+'""></div></div');

                  $('#data_kl').append('<div class="col-lg-3"><div class="form-group"><select id="gender_kl-'+response.idl_kl+'" class="form-control select2-show-search"><option value="Perempuan">Perempuan</option><option value="Laki-Laki">Laki-Laki</option></select></div></div');

                  $('#data_kl').append('<div class="col-lg-3"><div class="form-group"><input type="text" class="form-control" value="'+response.dphone_kl+'""></div></div');

                  $("#hubungan_kl-"+response.idl_kl).val(response.hub_kl).trigger("change");
                  $("#gender_kl-"+response.idl_kl).val(response.gender_kl).trigger("change");
                        
              },
              error: function (error) {
                  alert('Terjadi kesalahan sistem, hubungi IT.')
              }
          });

      });
  

</script>

<!-- Linked Field -->
<script>
  $(document).on('click change', '#thubungan_keluarga', function() {
      if ($('#thubungan_keluarga :selected').text() == "Ayah") {
          $('#tgender_keluarga').val('Laki-Laki').trigger("change");
      } else if($('#thubungan_keluarga :selected').text() == "Ibu" || $('#thubungan_keluarga :selected').text() == "Istri"){
        $('#tgender_keluarga').val('Perempuan').trigger("change");
      } else{
        $('#tgender_keluarga').val('').trigger("change");
      }
  });

  $(document).on('click change', '#thubungan_kl', function() {
      if ($('#thubungan_kl :selected').text() == "Ayah") {
          $('#tgender_kl').val('Laki-Laki').trigger("change");
      } else if($('#thubungan_kl :selected').text() == "Ibu" || $('#thubungan_kl :selected').text() == "Istri"){
        $('#tgender_kl').val('Perempuan').trigger("change");
      } else{
        $('#tgender_kl').val('').trigger("change");
      }
  });
</script>

{% endblock hrd_ajax %}